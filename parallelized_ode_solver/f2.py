'''
This file is converted from the file pollu.f, that is provided as 
part of the Test Set for IVP solvers
    http://www.dm.uniba.it/~testset/

Pollution problem
ODE of dimension 20

Daniel R. Reynolds
SMU Math 6370
January 2012
'''

def f2_basis(t, y):
    k1  = 0.35
    k2  = 26.6
    k3  = 1.23e4
    k4  = 8.6e-4
    k5  = 8.2e-4
    k6  = 1.5e4
    k7  = 1.3e-4
    k8  = 2.4e4
    k9  = 1.65e4
    k10 = 9.0e3
    k11 = 2.2e-2
    k12 = 1.2e4
    k13 = 1.88
    k14 = 1.63e4
    k15 = 4.8e6
    k16 = 3.5e-4
    k17 = 1.75e-2
    k18 = 1.0e8
    k19 = 4.44e11
    k20 = 1.24e3
    k21 = 2.1
    k22 = 5.78
    k23 = 4.74e-2
    k24 = 1.78e3
    k25 = 3.12

    r = [0 for _ in range(25)]
    r[0] = y[0]
    r[1] = k2 *y[1]*y[3]
    r[2] = k3 *y[4]*y[1]
    r[3] = k4 *y[6]
    r[4] = k5 *y[6]
    r[5] = k6 *y[6]*y[5]
    r[6] = k7 *y[8]
    r[7] = k8 *y[8]*y[5]
    r[8] = k9 *y[10]*y[1]
    r[9] = k10*y[10]*y[0]
    r[10] = k11*y[12]
    r[11] = k12*y[9]*y[1]
    r[12] = k13*y[13]
    r[13] = k14*y[0]*y[5]
    r[14] = k15*y[2]
    r[15] = k16*y[3]
    r[16] = k17*y[3]
    r[17] = k18*y[15]
    r[18] = k19*y[15]
    r[19] = k20*y[16]*y[5]
    r[20] = k21*y[18]
    r[21] = k22*y[18]
    r[22] = k23*y[0]*y[3]
    r[23] = k24*y[18]*y[0]
    r[24] = k25*y[19]

    return r

#         0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24
w_f2 = [[-1,  1,  1,  0,  0,  0,  0,  0,  1, -1,  1,  1,  0, -1,  0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  1], #  0
        [ 1, -1, -1,  0,  0,  0,  0,  0, -1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0], #  1
        [1,   0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  1,  0,  1,  0,  0,  1,  0,  0,  0], #  2
        [0,  -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  0,  0,  0,  0,  0, -1,  0,  0], #  3
        [0,   0, -1,  2,  0,  1,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0], #  4
        [0,   0,  1,  0,  0, -1,  0, -1,  0,  0,  0,  0,  0, -1,  0,  0,  0,  2,  0, -1,  0,  0,  0,  0,  0], #  5
        [0,   0,  0, -1, -1, -1,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], #  6
        [0,   0,  0,  1,  1,  1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], #  7
        [0,   0,  0,  0,  0,  0, -1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], #  8
        [0,   0,  0,  0,  0,  0,  1,  0,  1,  0,  0, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], #  9
        [ 0,  0,  0,  0,  0,  0,  0,  1, -1, -1,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], # 10
        [ 0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], # 11
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], # 12
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], # 13
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0], # 14
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0, -1, -1,  0,  0,  0,  0,  0,  0], # 15
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1,  0,  0,  0,  0,  0], # 16
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0], # 17
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, -1, -1,  1, -1,  1], # 18
        [ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1, -1]  # 19
        ]

y0 = [0. for _ in range(20)]
y0[0] = 0.0
y0[1] = 0.2
y0[2] = 0.0
y0[3] = 0.04
y0[4] = 0.0
y0[5] = 0.0
y0[6] = 0.1
y0[7] = 0.3
y0[8] = 0.01
y0[9] = 0.0
y0[10] = 0.0
y0[11] = 0.0
y0[12] = 0.0
y0[13] = 0.0
y0[14] = 0.0
y0[15] = 0.0
y0[16] = 0.007
y0[17] = 0.0
y0[18] = 0.0
y0[19] = 0.0


lasr_time_f2 = 60